# PromptOS Policy Rules v1.0.0
# Default policy rules for prompt validation

rules:
  # Rule 1: No PII in prompts
  - id: no-pii
    name: No Personal Identifiable Information
    description: Prompts must not contain PII such as names, emails, phone numbers
    severity: error
    enabled: true
    patterns:
      - '[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}'
      - '\b\d{3}[-.]?\d{3}[-.]?\d{4}\b'
      - '\b\(\d{3}\)\s*\d{3}[-.]?\d{4}\b'
      - '\b\d{3}-\d{2}-\d{4}\b'
      - '\b\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\b'

  # Rule 2: No hardcoded API keys
  - id: no-api-keys
    name: No Hardcoded API Keys
    description: Prompts must not contain hardcoded API keys, tokens, or secrets
    severity: error
    enabled: true
    patterns:
      - 'api[_-]?key["\s:=]+[a-zA-Z0-9_-]{20,}'
      - 'apikey["\s:=]+[a-zA-Z0-9_-]{20,}'
      - 'api[_-]?secret["\s:=]+[a-zA-Z0-9_-]{20,}'
      - 'secret[_-]?key["\s:=]+[a-zA-Z0-9_-]{20,}'
      - 'access[_-]?token["\s:=]+[a-zA-Z0-9_-]{20,}'
      - 'bearer[_\s]+[a-zA-Z0-9_-]{20,}'
      - 'sk-[a-zA-Z0-9]{20,}'
      - 'AKIA[0-9A-Z]{16}'
      - 'ghp_[a-zA-Z0-9]{36}'
      - 'github_pat_[a-zA-Z0-9_]{22,}'

  # Rule 3: Max prompt length
  - id: max-length
    name: Maximum Prompt Length
    description: Prompts must not exceed 8192 tokens
    severity: error
    enabled: true
    max_tokens: 8192

  # Rule 4: Required fields
  - id: required-fields
    name: Required Fields
    description: Required fields must be present
    severity: error
    enabled: true
    required_fields:
      - id
      - name
      - description
      - role
      - version
      - prompt

  # Rule 5: Version must be semver compliant
  - id: semver-version
    name: Semantic Version Compliance
    description: Version must follow semantic versioning format
    severity: error
    enabled: true
    version_pattern: '^\d+\.\d+\.\d+(-[a-zA-Z0-9.-]+)?(\+[a-zA-Z0-9.-]+)?$'

  # Rule 6: Examples field recommended
  - id: examples-recommended
    name: Examples Recommended
    description: Prompts should include examples
    severity: warning
    enabled: true

  # Rule 7: Category should be valid
  - id: valid-category
    name: Valid Category
    description: Category should be one of the defined categories
    severity: warning
    enabled: true
    valid_categories:
      - codegen
      - debugging
      - docs
      - sre
      - architecture

# Default settings
settings:
  max_prompt_length: 8192
  fail_on_error: true
  fail_on_warning: false
