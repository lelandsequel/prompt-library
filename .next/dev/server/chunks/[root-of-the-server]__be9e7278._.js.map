{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///Users/sokpyeon/.openclaw/workspace/prompt-library/src/app/api/optimize/route.ts"],"sourcesContent":["import { NextRequest, NextResponse } from 'next/server';\nimport Anthropic from '@anthropic-ai/sdk';\n\n// Initialize Anthropic client\nconst anthropic = new Anthropic({\n  apiKey: process.env.ANTHROPIC_API_KEY || '',\n});\n\nconst llmSystemPrompts: Record<string, string> = {\n  chatgpt: `You are an expert at optimizing prompts for OpenAI's ChatGPT models. \nYour task is to rewrite the user's prompt to get the best possible response from ChatGPT.\nFocus on:\n- Clear and specific instructions\n- Proper context and background\n- Structured format when needed\n- Explicit output format expectations\nReturn ONLY the optimized prompt, no explanations.`,\n\n  claude: `You are an expert at optimizing prompts for Anthropic's Claude models.\nYour task is to rewrite the user's prompt to get the best possible response from Claude.\nClaude responds well to:\n- XML-tagged sections (<context>, <task>, <requirements>)\n- Step-by-step instructions\n- Clear role definitions\n- Explicit constraints\nReturn ONLY the optimized prompt, no explanations.`,\n\n  cursor: `You are an expert at optimizing prompts for Cursor AI code editor.\nYour task is to rewrite the user's prompt to get the best code completion results from Cursor.\nFocus on:\n- Clear code context\n- Specific file/target specifications\n- Explicit coding tasks\n- Proper code formatting in prompts\nReturn ONLY the optimized prompt, no explanations.`,\n\n  copilot: `You are an expert at optimizing prompts for GitHub Copilot.\nYour task is to rewrite the user's prompt to get the best code completion from Copilot.\nFocus on:\n- Concise, clear comments\n- Context about what the code should do\n- Proper language specifications\n- Minimal but sufficient context\nReturn ONLY the optimized prompt, no explanations.`,\n\n  gemini: `You are an expert at optimizing prompts for Google Gemini.\nYour task is to rewrite the user's prompt to get the best possible response from Gemini.\nFocus on:\n- Clear instructions\n- Structured format\n- Explicit output expectations\n- Reasoning requests when helpful\nReturn ONLY the optimized prompt, no explanations.`\n};\n\nexport async function POST(request: NextRequest) {\n  try {\n    const body = await request.json();\n    const { prompt, targetLlm } = body;\n\n    if (!prompt || !targetLlm) {\n      return NextResponse.json(\n        { error: 'Missing required fields: prompt and targetLlm' },\n        { status: 400 }\n      );\n    }\n\n    const systemPrompt = llmSystemPrompts[targetLlm];\n    if (!systemPrompt) {\n      return NextResponse.json(\n        { error: `Unsupported target LLM: ${targetLlm}` },\n        { status: 400 }\n      );\n    }\n\n    // Call Anthropic API with Claude Haiku\n    const response = await anthropic.messages.create({\n      model: 'claude-3-haiku-20240307',\n      max_tokens: 2000,\n      temperature: 0.7,\n      system: systemPrompt,\n      messages: [\n        { \n          role: 'user', \n          content: `Please optimize this prompt for ${targetLlm}:\\n\\n${prompt}` \n        }\n      ]\n    });\n\n    const optimizedPrompt = response.content[0].type === 'text' \n      ? response.content[0].text \n      : '';\n\n    if (!optimizedPrompt) {\n      return NextResponse.json(\n        { error: 'No response from API' },\n        { status: 500 }\n      );\n    }\n\n    return NextResponse.json({ optimizedPrompt });\n  } catch (error) {\n    console.error('Optimization error:', error);\n    return NextResponse.json(\n      { error: 'Internal server error' },\n      { status: 500 }\n    );\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;AAAA;;;AAEA,8BAA8B;AAC9B,MAAM,YAAY,IAAI,wMAAS,CAAC;IAC9B,QAAQ,QAAQ,GAAG,CAAC,iBAAiB,IAAI;AAC3C;AAEA,MAAM,mBAA2C;IAC/C,SAAS,CAAC;;;;;;;kDAOsC,CAAC;IAEjD,QAAQ,CAAC;;;;;;;kDAOuC,CAAC;IAEjD,QAAQ,CAAC;;;;;;;kDAOuC,CAAC;IAEjD,SAAS,CAAC;;;;;;;kDAOsC,CAAC;IAEjD,QAAQ,CAAC;;;;;;;kDAOuC,CAAC;AACnD;AAEO,eAAe,KAAK,OAAoB;IAC7C,IAAI;QACF,MAAM,OAAO,MAAM,QAAQ,IAAI;QAC/B,MAAM,EAAE,MAAM,EAAE,SAAS,EAAE,GAAG;QAE9B,IAAI,CAAC,UAAU,CAAC,WAAW;YACzB,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAgD,GACzD;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,eAAe,gBAAgB,CAAC,UAAU;QAChD,IAAI,CAAC,cAAc;YACjB,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO,CAAC,wBAAwB,EAAE,WAAW;YAAC,GAChD;gBAAE,QAAQ;YAAI;QAElB;QAEA,uCAAuC;QACvC,MAAM,WAAW,MAAM,UAAU,QAAQ,CAAC,MAAM,CAAC;YAC/C,OAAO;YACP,YAAY;YACZ,aAAa;YACb,QAAQ;YACR,UAAU;gBACR;oBACE,MAAM;oBACN,SAAS,CAAC,gCAAgC,EAAE,UAAU,KAAK,EAAE,QAAQ;gBACvE;aACD;QACH;QAEA,MAAM,kBAAkB,SAAS,OAAO,CAAC,EAAE,CAAC,IAAI,KAAK,SACjD,SAAS,OAAO,CAAC,EAAE,CAAC,IAAI,GACxB;QAEJ,IAAI,CAAC,iBAAiB;YACpB,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAuB,GAChC;gBAAE,QAAQ;YAAI;QAElB;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE;QAAgB;IAC7C,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,uBAAuB;QACrC,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO;QAAwB,GACjC;YAAE,QAAQ;QAAI;IAElB;AACF"}}]
}